{{- if (eq .chezmoi.os "darwin") -}}
#!/bin/sh

source /tmp/chezmoi-utils.sh

printf "${green}[03 - Python] ${reset}"
{{- if or (lt 03 (atoi (env "SCRIPTS_START_AT"))) (env "SKIP_PYTHON") }}
echo "Skip installing python and packages"
exit 0
{{ else }}
echo "Install python and packages"
{{- end }}

set -eufo pipefail

# Link Homebrew's Python versions
# mkdir -p {{ .chezmoi.homeDir }}/.pyenv/versions/
# ln -s $(brew --cellar python)/* {{ .chezmoi.homeDir }}/.pyenv/versions/

# Set global Python version
if pyenv versions | grep -q "3.10.1"; then
    pyenv global 3.10.1
else
    pyenv install 3.10.1
    pyenv global 3.10.1
fi

# Setup virtualenvs
pipx ensurepath
pipx install pipenv

# Install packages from Pipfile with pipenv. Read more here: https://liatas.com/posts/anaconda-vs-pyenv-pipenv/

# Install additional productivity / command line tools
pipx install subliminal

{{ end -}}
